# ICAO Local PKD - Environment Variables Template
# Copy this file to .env and fill in actual values
# DO NOT COMMIT .env FILE TO GIT!

# =============================================================================
# PostgreSQL Configuration
# =============================================================================
DB_HOST=postgres
DB_PORT=5432
DB_NAME=pkd
DB_USER=pkd
DB_PASSWORD=                    # REQUIRED: Set strong password here

# =============================================================================
# LDAP Configuration
# =============================================================================
# v2.0.1: Application-level LDAP load balancing (HAProxy removed)
# LDAP Read: Round-robin across multiple LDAP servers (comma-separated host:port list)
# LDAP Write: Direct to openldap1 (MMR primary master)
# Note: Application handles load balancing internally for better libldap compatibility
LDAP_READ_HOSTS=openldap1:389,openldap2:389
LDAP_WRITE_HOST=openldap1
LDAP_WRITE_PORT=389
# v2.0.1: Application-level LDAP load balancing (HAProxy removed)
# LDAP Read: Round-robin across multiple LDAP servers (comma-separated host:port list)
# LDAP Write: Direct to openldap1 (MMR primary master)
# Note: Application handles load balancing internally for better libldap compatibility
LDAP_READ_HOSTS=openldap1:389,openldap2:389
LDAP_WRITE_HOST=openldap1
LDAP_WRITE_PORT=389
# v2.0.1: Application-level LDAP load balancing (HAProxy removed)
# LDAP Read: Round-robin across multiple LDAP servers (comma-separated host:port list)
# LDAP Write: Direct to openldap1 (MMR primary master)
# Note: Application handles load balancing internally for better libldap compatibility
LDAP_READ_HOSTS=openldap1:389,openldap2:389
LDAP_WRITE_HOST=openldap1
LDAP_WRITE_PORT=389
# v2.0.1: Application-level LDAP load balancing (HAProxy removed)
# LDAP Read: Round-robin across multiple LDAP servers (comma-separated host:port list)
# LDAP Write: Direct to openldap1 (MMR primary master)
# Note: Application handles load balancing internally for better libldap compatibility
LDAP_READ_HOSTS=openldap1:389,openldap2:389
LDAP_WRITE_HOST=openldap1
LDAP_WRITE_PORT=389
# v2.0.1: Application-level LDAP load balancing (HAProxy removed)
# LDAP Read: Round-robin across multiple LDAP servers (comma-separated host:port list)
# LDAP Write: Direct to openldap1 (MMR primary master)
# Note: Application handles load balancing internally for better libldap compatibility
LDAP_READ_HOSTS=openldap1:389,openldap2:389
LDAP_WRITE_HOST=openldap1
LDAP_WRITE_PORT=389
# v2.0.1: Application-level LDAP load balancing (HAProxy removed)
# LDAP Read: Round-robin across multiple LDAP servers (comma-separated host:port list)
# LDAP Write: Direct to openldap1 (MMR primary master)
# Note: Application handles load balancing internally for better libldap compatibility
LDAP_READ_HOSTS=openldap1:389,openldap2:389
LDAP_WRITE_HOST=openldap1
LDAP_WRITE_PORT=389
# v2.0.1: Application-level LDAP load balancing (HAProxy removed)
# LDAP Read: Round-robin across multiple LDAP servers (comma-separated host:port list)
# LDAP Write: Direct to openldap1 (MMR primary master)
# Note: Application handles load balancing internally for better libldap compatibility
LDAP_READ_HOSTS=openldap1:389,openldap2:389
LDAP_WRITE_HOST=openldap1
LDAP_WRITE_PORT=389
# v2.0.1: Application-level LDAP load balancing (HAProxy removed)
# LDAP Read: Round-robin across multiple LDAP servers (comma-separated host:port list)
# LDAP Write: Direct to openldap1 (MMR primary master)
# Note: Application handles load balancing internally for better libldap compatibility
LDAP_READ_HOSTS=openldap1:389,openldap2:389
LDAP_WRITE_HOST=openldap1
LDAP_WRITE_PORT=389
# v2.0.1: Application-level LDAP load balancing (HAProxy removed)
# LDAP Read: Round-robin across multiple LDAP servers (comma-separated host:port list)
# LDAP Write: Direct to openldap1 (MMR primary master)
# Note: Application handles load balancing internally for better libldap compatibility
LDAP_READ_HOSTS=openldap1:389,openldap2:389
LDAP_WRITE_HOST=openldap1
LDAP_WRITE_PORT=389
# v2.0.1: Application-level LDAP load balancing (HAProxy removed)
# LDAP Read: Round-robin across multiple LDAP servers (comma-separated host:port list)
# LDAP Write: Direct to openldap1 (MMR primary master)
# Note: Application handles load balancing internally for better libldap compatibility
LDAP_READ_HOSTS=openldap1:389,openldap2:389
LDAP_WRITE_HOST=openldap1
LDAP_WRITE_PORT=389
# v2.0.1: Application-level LDAP load balancing (HAProxy removed)
# LDAP Read: Round-robin across multiple LDAP servers (comma-separated host:port list)
# LDAP Write: Direct to openldap1 (MMR primary master)
# Note: Application handles load balancing internally for better libldap compatibility
LDAP_READ_HOSTS=openldap1:389,openldap2:389
LDAP_WRITE_HOST=openldap1
LDAP_WRITE_PORT=389

# LDAP DIT Structure (runtime configurable - optional)
LDAP_DATA_CONTAINER=dc=data         # Container for normal certificates (default: dc=data)
LDAP_NC_DATA_CONTAINER=dc=nc-data   # Container for non-conformant DSC (default: dc=nc-data)

# =============================================================================
# PostgreSQL (Infrastructure - for docker-compose)
# =============================================================================
POSTGRES_USER=pkd
POSTGRES_PASSWORD=              # Same as DB_PASSWORD

# =============================================================================
# OpenLDAP (Infrastructure - for docker-compose)
# =============================================================================
LDAP_ADMIN_PASSWORD=            # Same as LDAP_BIND_PASSWORD
LDAP_CONFIG_PASSWORD=           # Set config password (e.g., config123)

# =============================================================================
# JWT Authentication Configuration (Phase 3 - Required for v2.0.0+)
# =============================================================================
# CRITICAL: JWT_SECRET_KEY must be set for authentication to work
# Generate a secure secret key with: openssl rand -hex 32
JWT_SECRET_KEY=                      # REQUIRED: Min 32 chars, use openssl rand -hex 32

# JWT issuer identifier (appears in token claims)
JWT_ISSUER=icao-pkd                  # Default: icao-pkd

# Token expiration time in seconds (3600 = 1 hour)
JWT_EXPIRATION_SECONDS=3600          # Default: 3600 (1 hour)

# Authentication toggle (for testing/migration only - DO NOT disable in production)
AUTH_ENABLED=true                    # Default: true, set false ONLY for testing

# =============================================================================
# Service Ports (Optional - defaults are fine for most cases)
# =============================================================================
# PKD_MANAGEMENT_PORT=8081
# PA_SERVICE_PORT=8082
# SYNC_SERVICE_PORT=8083
# API_GATEWAY_PORT=8080
# FRONTEND_PORT=3000

# =============================================================================
# ICAO Auto Sync Configuration (Optional - v1.7.0+)
# =============================================================================
# ICAO_PORTAL_URL=https://pkddownloadsg.icao.int/
# ICAO_NOTIFICATION_EMAIL=admin@localhost
# ICAO_AUTO_NOTIFY=true
# ICAO_HTTP_TIMEOUT=10

# =============================================================================
# Sync Service Configuration (Optional)
# =============================================================================
# AUTO_RECONCILE=true
# MAX_RECONCILE_BATCH_SIZE=100
# DAILY_SYNC_ENABLED=true
# DAILY_SYNC_HOUR=0
# DAILY_SYNC_MINUTE=0
# REVALIDATE_CERTS_ON_SYNC=true

# =============================================================================
# Security Notes
# =============================================================================
# PASSWORDS:
# - Use strong passwords (min 16 characters, mix of letters/numbers/symbols)
# - Rotate passwords regularly
# - Use different passwords for each environment (dev, staging, production)
#
# JWT SECURITY:
# - JWT_SECRET_KEY must be at least 32 characters (64 recommended)
# - Generate with: openssl rand -hex 32
# - NEVER expose JWT_SECRET_KEY in logs or error messages
# - Change JWT_SECRET_KEY immediately if compromised (invalidates all tokens)
# - Keep JWT_EXPIRATION_SECONDS reasonable (1 hour default)
#
# GENERAL:
# - Never commit .env file to version control (.gitignore is configured)
# - For production, consider using Docker Secrets or external secret management
# - AUTH_ENABLED=false should NEVER be used in production environments
