# v2.3.0 Work Plan - Frontend Enhancements

**Planning Date**: 2026-02-01
**Target Version**: v2.3.0
**Status**: Planning Phase
**Estimated Effort**: 8-12 hours

---

## Overview

Version 2.3.0 focuses on frontend enhancements to visualize real-time certificate metadata, ICAO 9303 compliance status, and algorithm/key size distributions. This builds upon the Phase 4.4 backend infrastructure (ProgressManager, X.509 metadata extraction, ICAO compliance checker) that was completed in v2.2.0.

---

## Background

### What Was Already Completed in v2.2.0

**Backend Infrastructure (Phase 4.4 - Complete)**:
- ✅ ProgressManager with CertificateMetadata tracking (22 fields)
- ✅ ICAO 9303 Compliance Checker (6 validation categories)
- ✅ ValidationStatistics aggregation (10+ fields)
- ✅ SSE (Server-Sent Events) streaming every 50 certificates
- ✅ X.509 metadata extraction (13 helper functions)
- ✅ Enhanced metadata integration in LDIF/Master List processing

**Current State**:
- Backend sends real-time statistics via SSE during upload
- Frontend receives SSE events but doesn't display them yet
- Metadata is stored in database but not visualized
- ICAO compliance status calculated but not shown in UI

**Reference**:
- [PHASE_4.4_TASK_3_COMPLETION.md](PHASE_4.4_TASK_3_COMPLETION.md)
- [REPOSITORY_PATTERN_IMPLEMENTATION_SUMMARY.md](REPOSITORY_PATTERN_IMPLEMENTATION_SUMMARY.md)

---

## Deferred Tasks from v2.2.0

The following tasks were identified in Phase 4.4 but deferred to v2.3.0:

### 1. Real-time Statistics Dashboard (3-4 hours)

**Goal**: Display live upload progress with metadata during certificate processing

**Components to Create**:
- `frontend/src/components/UploadProgressDashboard.tsx` - Main dashboard component
- `frontend/src/hooks/useUploadProgress.ts` - SSE event handling hook

**Features**:
- Live progress bar with percentage (0-100%)
- Current stage indicator (VALIDATION_IN_PROGRESS, etc.)
- Processed count vs total count display
- Certificate type breakdown (CSCA, DSC, DSC_NC, MLSC, CRL)
- Real-time statistics updates every 50 certificates

**SSE Event Format** (Already implemented in backend):
```json
{
  "uploadId": "uuid",
  "stage": "VALIDATION_IN_PROGRESS",
  "percentage": 50,
  "processedCount": 15000,
  "totalCount": 29838,
  "message": "처리 중: DSC 14500/29838, CSCA 500/29838",
  "statistics": {
    "totalCertificates": 15000,
    "icaoCompliantCount": 8500,
    "signatureAlgorithms": {"sha256WithRSAEncryption": 12000, "ecdsa-with-SHA256": 3000},
    "keySizes": {"2048": 5000, "4096": 7000, "256": 3000},
    "certificateTypes": {"DSC": 14500, "CSCA": 500}
  }
}
```

**Implementation Notes**:
- Use EventSource API for SSE connection
- Handle connection close, error, and reconnection
- Display dashboard in UploadHistory page during active uploads
- Persist final statistics after upload completion

### 2. Certificate Metadata Card (2-3 hours)

**Goal**: Display detailed X.509 metadata for individual certificates

**Components to Create**:
- `frontend/src/components/CertificateMetadataCard.tsx` - Metadata display component
- Extend `CertificateSearch.tsx` to show metadata in detail dialog

**Metadata Fields to Display** (22 fields total):

**Algorithm Information** (6 fields):
- version (X.509 v1/v2/v3)
- signature_algorithm (e.g., sha256WithRSAEncryption)
- signature_hash_algorithm (e.g., SHA-256)
- public_key_algorithm (RSA/ECDSA)
- public_key_size (2048, 4096, 256, 384)
- public_key_curve (secp256r1, etc. for ECDSA)

**Key Usage** (2 fields):
- key_usage (keyCertSign, cRLSign, digitalSignature)
- extended_key_usage (serverAuth, clientAuth, etc.)

**CA Information** (2 fields):
- is_ca (TRUE/FALSE)
- path_len_constraint (0, 1, 2, etc.)

**Identifiers** (2 fields):
- subject_key_identifier (hex string)
- authority_key_identifier (hex string)

**Distribution Points** (2 fields):
- crl_distribution_points (URLs)
- ocsp_responder_url (URL)

**Validation** (1 field):
- is_self_signed (TRUE/FALSE)

**UI Design**:
- Grouped sections with headers
- Color-coded badges for key usage
- Icon indicators for CA status
- Copy-to-clipboard for identifiers

### 3. ICAO Compliance Badge (1-2 hours)

**Goal**: Visual indicators for ICAO 9303 compliance status

**Components to Create**:
- `frontend/src/components/IcaoComplianceBadge.tsx` - Badge component
- Integrate into CertificateSearch results and detail dialog

**Compliance Categories** (6 validation categories):
1. Key Usage (keyCertSign, cRLSign, digitalSignature)
2. Algorithm (sha256WithRSAEncryption, ecdsa-with-SHA256)
3. Key Size (≥2048 for RSA, ≥256 for ECDSA)
4. Validity Period (≤10 years for CSCA, ≤3 months for DSC)
5. DN Format (printableString encoding)
6. Extensions (basicConstraints, keyUsage, etc.)

**Badge States**:
- ✅ **Compliant** (green): All 6 categories pass
- ⚠️ **Partially Compliant** (yellow): 1-2 failures
- ❌ **Non-Compliant** (red): 3+ failures

**Tooltip**:
- Hover to see detailed compliance breakdown
- List failed checks with PKD conformance codes
- Example: "ERR:CSCA.KEY_USAGE - Missing keyCertSign"

### 4. Algorithm/Key Size Charts (2-3 hours)

**Goal**: Visualize algorithm and key size distribution across uploaded certificates

**Components to Create**:
- `frontend/src/components/AlgorithmDistributionChart.tsx` - Algorithm pie chart
- `frontend/src/components/KeySizeDistributionChart.tsx` - Key size bar chart
- Integrate into UploadHistory detail dialog and Dashboard

**Chart Library**:
- Use `recharts` (already in dependencies)
- Responsive design with dark mode support

**Algorithm Distribution Chart**:
- Pie chart showing signature algorithm breakdown
- Data: `signatureAlgorithms` from ValidationStatistics
- Categories: RSA-SHA256, RSA-SHA1, ECDSA-SHA256, etc.
- Percentages displayed on hover

**Key Size Distribution Chart**:
- Bar chart showing key size distribution
- Data: `keySizes` from ValidationStatistics
- Categories: 2048, 4096, 256 (ECDSA), 384 (ECDSA)
- Count displayed on each bar

**Display Location**:
- Upload detail dialog (per-upload statistics)
- Dashboard (system-wide statistics)
- Certificate Search (filtered by search criteria)

---

## Additional Tasks (Optional)

### 5. Upload Progress Page Enhancement (1-2 hours)

**Goal**: Improve live upload tracking UI

**Enhancements**:
- Add UploadProgressDashboard to Upload page
- Show real-time statistics during processing
- Auto-refresh after upload completion
- Error handling with retry functionality

### 6. Statistics API Enhancement (1 hour)

**Goal**: Add endpoint for system-wide algorithm/key size statistics

**New Endpoint**:
```
GET /api/statistics/algorithms
```

**Response**:
```json
{
  "signatureAlgorithms": {
    "sha256WithRSAEncryption": 27000,
    "ecdsa-with-SHA256": 3000,
    "sha1WithRSAEncryption": 500
  },
  "keySizes": {
    "2048": 10000,
    "4096": 20000,
    "256": 3000
  },
  "totalCertificates": 31215
}
```

**Implementation**:
- StatisticsRepository aggregation query
- StatisticsService business logic
- Controller endpoint

---

## Implementation Order

**Phase 1: Core Components (4-5 hours)**
1. Certificate Metadata Card (2-3 hours) - Immediate value, no dependencies
2. ICAO Compliance Badge (1-2 hours) - Depends on Metadata Card

**Phase 2: Real-time Features (3-4 hours)**
3. Real-time Statistics Dashboard (3-4 hours) - SSE integration
4. Upload Progress Page Enhancement (1 hour) - Depends on Dashboard

**Phase 3: Visualization (2-3 hours)**
5. Algorithm/Key Size Charts (2-3 hours) - Depends on Statistics API
6. Statistics API Enhancement (1 hour) - Backend work

**Total Estimated Time**: 8-12 hours

---

## Dependencies

**External Libraries**:
- `recharts` - Already installed (for charts)
- `EventSource` - Browser API (no installation needed)

**Backend APIs** (Already Implemented):
- SSE streaming during upload (LDIF/Master List processing)
- ValidationStatistics in upload completion response
- Certificate metadata in search results

**Data Availability**:
- ✅ X.509 metadata stored in certificate table (15 columns)
- ✅ ICAO compliance calculated during upload
- ✅ ValidationStatistics aggregated in ProgressManager

---

## Testing Plan

### Unit Tests
- [ ] CertificateMetadataCard component rendering
- [ ] IcaoComplianceBadge state logic
- [ ] useUploadProgress SSE hook

### Integration Tests
- [ ] Real-time statistics update during upload
- [ ] Chart rendering with real data
- [ ] Metadata card display in search results

### E2E Tests
- [ ] Upload Collection-001 and verify live statistics
- [ ] View metadata for various certificate types
- [ ] Check compliance badges for compliant/non-compliant certs

---

## Risks and Mitigations

**Risk 1: SSE Connection Stability**
- **Impact**: Real-time updates may fail on network interruptions
- **Mitigation**: Implement reconnection logic with exponential backoff

**Risk 2: Performance with Large Datasets**
- **Impact**: Charts may be slow with 30,000+ data points
- **Mitigation**: Implement data aggregation and sampling for large datasets

**Risk 3: Browser Compatibility**
- **Impact**: EventSource API not supported in old browsers
- **Mitigation**: Add polyfill for IE11 (if needed)

---

## Success Criteria

- [ ] Real-time statistics dashboard shows live progress during upload
- [ ] Certificate metadata card displays all 22 fields correctly
- [ ] ICAO compliance badge accurately reflects compliance status
- [ ] Algorithm/key size charts render correctly with real data
- [ ] All components support dark mode
- [ ] Performance acceptable with 30,000+ certificates
- [ ] E2E tests pass for all components

---

## Documentation Updates

After v2.3.0 completion:
- [ ] Update CLAUDE.md with v2.3.0 features
- [ ] Create V2.3.0_COMPLETION.md
- [ ] Update DEVELOPMENT_GUIDE.md with new UI components
- [ ] Add screenshots to documentation

---

## Out of Scope (Future Versions)

The following are **not** included in v2.3.0:

- ❌ Search/filter functionality for DN tree (v2.4.0)
- ❌ Export DN tree to JSON/CSV (v2.4.0)
- ❌ Diff view for comparing LDIF structures (v2.4.0)
- ❌ Performance optimization for very large files (50,000+ entries) (v2.4.0)
- ❌ Advanced validation rule customization (v2.5.0)
- ❌ Batch certificate operations (v2.5.0)

---

## Notes

- This is a **frontend-only** release - no backend changes required
- All backend infrastructure (Phase 4.4) already complete in v2.2.0
- Focus on user experience and data visualization
- Can be released incrementally (Phase 1 → Phase 2 → Phase 3)
