<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICAO Local PKD - Software Architecture v1.7.1</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.0/dist/reset.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.0/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.0/dist/theme/white.css">
    <style>
        .reveal h1, .reveal h2, .reveal h3 { color: #003366; }
        .reveal section { text-align: left; }
        .reveal ul { font-size: 0.9em; }
        .reveal .layer-box {
            padding: 20px;
            margin: 10px 0;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            text-align: center;
        }
        .reveal .service-box {
            display: inline-block;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
        }
        .mermaid { font-size: 14px; }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">
            <!-- Title Slide -->
            <section>
                <h1>ICAO Local PKD</h1>
                <h3>Software Architecture</h3>
                <p>Version 1.7.1</p>
            </section>

            <!-- System Overview -->
            <section>
                <h2>ì‹œìŠ¤í…œ ê°œìš”</h2>
            </section>

            <section>
                <h3>í•µì‹¬ ê¸°ëŠ¥</h3>
                <ul>
                    <li>âœ… LDIF/Master List íŒŒì¼ ì—…ë¡œë“œ ë° íŒŒì‹±</li>
                    <li>âœ… Trust Chain ê²€ì¦ (CSCA â†’ DSC)</li>
                    <li>âœ… ICAO 9303 Passive Authentication</li>
                    <li>âœ… PostgreSQL + OpenLDAP MMR í´ëŸ¬ìŠ¤í„°</li>
                    <li>âœ… DB-LDAP ìë™ ë™ê¸°í™”</li>
                    <li>âœ… React 19 ê¸°ë°˜ ì›¹ ì¸í„°í˜ì´ìŠ¤</li>
                    <li>âœ… ICAO Auto Sync (v1.7.0)</li>
                </ul>
            </section>

            <section>
                <h3>ê¸°ìˆ  ìŠ¤íƒ</h3>
                <ul>
                    <li><strong>Backend:</strong> C++20 + Drogon Framework</li>
                    <li><strong>Database:</strong> PostgreSQL 15</li>
                    <li><strong>Directory:</strong> OpenLDAP MMR</li>
                    <li><strong>Frontend:</strong> React 19 + TypeScript + Vite</li>
                    <li><strong>Crypto:</strong> OpenSSL 3.x</li>
                    <li><strong>Gateway:</strong> Nginx</li>
                    <li><strong>Container:</strong> Docker Compose</li>
                </ul>
            </section>

            <!-- Architecture -->
            <section>
                <h2>ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</h2>
            </section>

            <section>
                <h3>ê¸°ìˆ  ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ (v1.7.1)</h3>
                <div class="mermaid">
graph TB
    subgraph External["ğŸŒ ì™¸ë¶€ ì˜ì—­"]
        User["ğŸ‘¤ ì‚¬ìš©ì<br/>ì›¹ ë¸Œë¼ìš°ì €"]
        ExtAPI["ğŸ”Œ ì™¸ë¶€ API<br/>í´ë¼ì´ì–¸íŠ¸"]
        ICAOPortal["ğŸŒ ICAO Portal<br/>download.pkd.icao.int"]
    end
    subgraph DMZ["ğŸ”’ DMZ ì˜ì—­"]
        Frontend["âš¡ Frontend<br/>React 19<br/>:3000"]
        APIGateway["ğŸ”€ API Gateway<br/>Nginx<br/>:8080"]
        HAProxy["âš–ï¸ LDAP LB<br/>HAProxy<br/>:389"]
    end
    subgraph AppLayer["ğŸ”§ ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ"]
        PKD["ğŸ“¦ PKD Management<br/>C++20<br/>:8081"]
        PA["ğŸ” PA Service<br/>C++20<br/>:8082"]
        Relay["ğŸ”„ PKD Relay<br/>C++20<br/>:8083"]
        Monitor["ğŸ“Š Monitoring<br/>C++20<br/>:8084"]
        CronJob["â° Cron Job<br/>08:00 KST"]
        DailySync["ğŸ“… Daily Sync<br/>00:00 UTC"]
    end
    subgraph DataLayer["ğŸ’¾ ë°ì´í„° ê³„ì¸µ"]
        PostgreSQL[("ğŸ—„ï¸ PostgreSQL<br/>:5432<br/>30,637 certs")]
        LDAP1[("ğŸ“‚ LDAP Master 1<br/>:3891<br/>MMR")]
        LDAP2[("ğŸ“‚ LDAP Master 2<br/>:3892<br/>MMR")]
        Uploads["ğŸ“ Upload Files<br/>/app/uploads"]
        Logs["ğŸ“‹ App Logs<br/>/app/logs"]
    end
    subgraph Infrastructure["ğŸ—ï¸ ì¸í”„ë¼"]
        Docker["ğŸ³ Docker Compose<br/>icao-network"]
        Platform["ğŸ’» ë°°í¬ í”Œë«í¼<br/>ARM64/AMD64"]
    end
    subgraph CICD["ğŸš€ CI/CD"]
        GitHub["ğŸ“¦ GitHub Actions<br/>Multi-arch"]
        Deploy["ğŸ¯ Auto Deploy<br/>skopeo/sshpass"]
    end
    User --> Frontend
    User --> APIGateway
    ExtAPI --> APIGateway
    ExtAPI --> HAProxy
    ICAOPortal -.-> PKD
    Frontend --> APIGateway
    APIGateway --> PKD
    APIGateway --> PA
    APIGateway --> Relay
    APIGateway --> Monitor
    HAProxy --> LDAP1
    HAProxy --> LDAP2
    PKD --> PostgreSQL
    PKD --> LDAP1
    PKD --> HAProxy
    PA --> PostgreSQL
    PA --> HAProxy
    Relay --> PostgreSQL
    Relay --> HAProxy
    Relay --> LDAP1
    Monitor --> PostgreSQL
    Monitor --> PKD
    Monitor --> PA
    Monitor --> Relay
    CronJob --> PKD
    DailySync --> Relay
    LDAP1 <--> LDAP2
    PKD --> Uploads
    PKD --> Logs
    PA --> Logs
    Relay --> Logs
    Monitor --> Logs
    Docker -.-> Frontend
    Docker -.-> APIGateway
    Docker -.-> PKD
    Docker -.-> PA
    Docker -.-> Relay
    Docker -.-> Monitor
    Docker -.-> PostgreSQL
    Docker -.-> LDAP1
    Docker -.-> LDAP2
    Docker -.-> HAProxy
    GitHub --> Deploy
    Deploy --> Platform
    classDef external fill:#E3F2FD,stroke:#1976D2,stroke-width:2px
    classDef dmz fill:#FFF3E0,stroke:#F57C00,stroke-width:2px
    classDef app fill:#E8F5E9,stroke:#388E3C,stroke-width:2px
    classDef data fill:#FCE4EC,stroke:#C2185B,stroke-width:2px
    classDef infra fill:#F3E5F5,stroke:#7B1FA2,stroke-width:2px
    classDef cicd fill:#E0F2F1,stroke:#00796B,stroke-width:2px
    class User,ExtAPI,ICAOPortal external
    class Frontend,APIGateway,HAProxy dmz
    class PKD,PA,Relay,Monitor,CronJob,DailySync app
    class PostgreSQL,LDAP1,LDAP2,Uploads,Logs data
    class Docker,Platform infra
    class GitHub,Deploy cicd
                </div>
            </section>

            <section>
                <h3>ì£¼ìš” ë°ì´í„° íë¦„ (v1.7.1)</h3>
                <ul style="font-size: 0.85em;">
                    <li><strong>ì—…ë¡œë“œ:</strong> Browser â†’ React â†’ API Gateway â†’ PKD Management â†’ PostgreSQL + LDAP</li>
                    <li><strong>PA ê²€ì¦:</strong> Browser â†’ React â†’ API Gateway â†’ PA Service â†’ PostgreSQL + LDAP</li>
                    <li><strong>ì¸ì¦ì„œ ê²€ìƒ‰:</strong> Browser â†’ React â†’ API Gateway â†’ PKD Management â†’ LDAP (ì½ê¸° ì „ìš©)</li>
                    <li><strong>ë™ê¸°í™”:</strong> Browser â†’ React â†’ API Gateway â†’ PKD Relay â†’ PostgreSQL + LDAP</li>
                    <li><strong>ICAO Auto Sync:</strong> Cron Job â†’ PKD Management â†’ ICAO Portal â†’ PostgreSQL</li>
                    <li><strong>ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§:</strong> Monitoring Service â†’ PKD/PA/Relay Health â†’ PostgreSQL Metrics</li>
                </ul>
            </section>

            <!-- Microservices -->
            <section>
                <h2>ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤</h2>
            </section>

            <section>
                <h3>PKD Management Service (8081)</h3>
                <ul>
                    <li>Clean Architecture (6 Layers)</li>
                    <li>LDIF/Master List ì—…ë¡œë“œ</li>
                    <li>Trust Chain ê²€ì¦</li>
                    <li>ì¸ì¦ì„œ ê²€ìƒ‰ ë° ë‚´ë³´ë‚´ê¸°</li>
                    <li>ICAO Auto Sync í†µí•©</li>
                    <li>Strategy Pattern (AUTO/MANUAL)</li>
                </ul>
            </section>

            <section>
                <h3>PA Service (8082)</h3>
                <ul>
                    <li>ICAO 9303 PA ì™„ì „ ì¤€ìˆ˜</li>
                    <li>SOD CMS ì„œëª… ê²€ì¦</li>
                    <li>DG í•´ì‹œ ê²€ì¦</li>
                    <li>Trust Chain ê²€ì¦</li>
                    <li>MRZ íŒŒì‹± (TD1/TD2/TD3)</li>
                    <li>ì–¼êµ´ ì´ë¯¸ì§€ ì¶”ì¶œ</li>
                </ul>
            </section>

            <section>
                <h3>PKD Relay Service (8083)</h3>
                <ul>
                    <li>DB-LDAP ë™ê¸°í™” ëª¨ë‹ˆí„°ë§</li>
                    <li>Auto Reconcile (ë°°ì¹˜ 100)</li>
                    <li>Daily Sync (00:00 UTC)</li>
                    <li>Trust Chain ì¬ê²€ì¦</li>
                    <li>ë¶ˆì¼ì¹˜ ìë™ ì¡°ì •</li>
                    <li>ì¡°ì • ì´ë ¥ ì¶”ì </li>
                </ul>
            </section>

            <section>
                <h3>Monitoring Service (8084) - NEW</h3>
                <ul>
                    <li>ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§ (5ì´ˆ ê°„ê²©)</li>
                    <li>CPU, Memory, Disk ì‚¬ìš©ë¥ </li>
                    <li>ì„œë¹„ìŠ¤ í—¬ìŠ¤ ì²´í¬ (30ì´ˆ ê°„ê²©)</li>
                    <li>PKD/PA/Relay ìƒíƒœ í™•ì¸</li>
                    <li>ë¡œê·¸ ë¶„ì„ (60ì´ˆ ê°„ê²©)</li>
                    <li>ë©”íŠ¸ë¦­ ë°ì´í„° 7ì¼ ë³´ê´€</li>
                </ul>
            </section>

            <!-- Database -->
            <section>
                <h2>ë°ì´í„° ê³„ì¸µ</h2>
            </section>

            <section>
                <h3>PostgreSQL í…Œì´ë¸” (9ê°œ)</h3>
                <ul style="font-size: 0.8em;">
                    <li><strong>uploaded_file:</strong> ì—…ë¡œë“œ íŒŒì¼ ë©”íƒ€ë°ì´í„°</li>
                    <li><strong>certificate:</strong> ì¸ì¦ì„œ (30,637ê°œ)</li>
                    <li><strong>crl:</strong> ì¸ì¦ì„œ íê¸° ëª©ë¡</li>
                    <li><strong>master_list:</strong> ICAO Master List</li>
                    <li><strong>validation_result:</strong> Trust Chain ê²€ì¦</li>
                    <li><strong>pa_verification:</strong> PA ê²€ì¦ ì´ë ¥</li>
                    <li><strong>sync_status:</strong> ë™ê¸°í™” ìƒíƒœ</li>
                    <li><strong>reconciliation_summary:</strong> ì¡°ì • ìš”ì•½</li>
                    <li><strong>icao_pkd_versions:</strong> ICAO ë²„ì „ ì¶”ì </li>
                </ul>
            </section>

            <section>
                <h3>LDAP ë””ë ‰í† ë¦¬ êµ¬ì¡°</h3>
                <pre style="font-size: 0.7em;"><code>dc=ldap,dc=smartcoreinc,dc=com
  â””â”€ dc=pkd
      â””â”€ dc=download
          â”œâ”€ dc=data (193ê°œ êµ­ê°€)
          â”‚   â””â”€ c=KR/US/JP...
          â”‚       â”œâ”€ o=csca (CSCA ì¸ì¦ì„œ)
          â”‚       â”œâ”€ o=dsc (DSC ì¸ì¦ì„œ)
          â”‚       â”œâ”€ o=crl (CRL)
          â”‚       â””â”€ o=ml (Master List)
          â””â”€ dc=nc-data (Non-Conformant DSC)</code></pre>
            </section>

            <!-- Deployment -->
            <section>
                <h2>ë°°í¬ ì•„í‚¤í…ì²˜</h2>
            </section>

            <section>
                <h3>Docker ì»¨í…Œì´ë„ˆ (v1.7.1)</h3>
                <ul style="font-size: 0.85em;">
                    <li>Frontend: Nginx + React 19 (3000)</li>
                    <li>API Gateway: Nginx (8080)</li>
                    <li>PKD Management: C++ (8081)</li>
                    <li>PA Service: C++ (8082)</li>
                    <li>PKD Relay: C++ (8083)</li>
                    <li>Monitoring: C++ (8084) - NEW</li>
                    <li>PostgreSQL: DB (5432)</li>
                    <li>OpenLDAP1/2: MMR (3891/3892)</li>
                    <li>HAProxy: LDAP LB (389)</li>
                    <li>Swagger UI: API Documentation (8080)</li>
                </ul>
            </section>

            <section>
                <h3>Luckfox ARM64 ë°°í¬</h3>
                <ul>
                    <li><strong>Device:</strong> Luckfox Pico</li>
                    <li><strong>IP:</strong> 192.168.100.11</li>
                    <li><strong>Network:</strong> Host Mode</li>
                    <li><strong>Build:</strong> GitHub Actions</li>
                    <li><strong>Deploy:</strong> OCI â†’ Docker (skopeo)</li>
                    <li><strong>Transfer:</strong> sshpass</li>
                </ul>
            </section>

            <!-- Performance & Security -->
            <section>
                <h2>ì„±ëŠ¥ ë° ë³´ì•ˆ</h2>
            </section>

            <section>
                <h3>ì„±ëŠ¥ ì§€í‘œ</h3>
                <ul>
                    <li><strong>Certificate Search:</strong> 2,222 req/s</li>
                    <li><strong>PA Verification:</strong> 416 req/s</li>
                    <li><strong>API Latency:</strong> &lt;100ms</li>
                    <li><strong>DB Query:</strong> 40ms</li>
                    <li><strong>LDAP Search:</strong> &lt;200ms</li>
                    <li><strong>Certificates:</strong> 30,637ê°œ</li>
                    <li><strong>Concurrent Users:</strong> 1,000+ í…ŒìŠ¤íŠ¸ ì™„ë£Œ</li>
                </ul>
            </section>

            <section>
                <h3>ë³´ì•ˆ ë ˆì´ì–´</h3>
                <ul style="font-size: 0.85em;">
                    <li><strong>ë„¤íŠ¸ì›Œí¬:</strong> ë°©í™”ë²½ + Docker ê²©ë¦¬</li>
                    <li><strong>ì• í”Œë¦¬ì¼€ì´ì…˜:</strong> Rate Limiting (100/s), CORS, CSP</li>
                    <li><strong>ë°ì´í„°:</strong> PostgreSQL ì¸ì¦, LDAP Bind, TLS/SSL</li>
                    <li><strong>ì½”ë“œ:</strong> SQL ì¸ì ì…˜ ë°©ì§€, XSS ë°©ì§€, ë§¤ê°œë³€ìˆ˜í™” ì¿¼ë¦¬</li>
                </ul>
            </section>

            <!-- ICAO Auto Sync -->
            <section>
                <h2>ICAO Auto Sync v1.7.0</h2>
            </section>

            <section>
                <h3>ìë™ ë™ê¸°í™” ê¸°ëŠ¥</h3>
                <ul>
                    <li>ë§¤ì¼ 08:00 ìë™ ë²„ì „ ì²´í¬</li>
                    <li>ICAO PKD í¬í„¸ HTML íŒŒì‹±</li>
                    <li>Collection 001/002/003 ì¶”ì </li>
                    <li>ì‹ ê·œ ë²„ì „ ê°ì§€ ì‹œ ì•Œë¦¼</li>
                    <li>ì´ë©”ì¼ ë°œì†¡ ì§€ì›</li>
                    <li>í”„ë¡ íŠ¸ì—”ë“œ ë°°ì§€ í‘œì‹œ</li>
                    <li>icao_pkd_versions ì €ì¥</li>
                </ul>
            </section>

            <!-- Summary -->
            <section>
                <h2>ìš”ì•½</h2>
            </section>

            <section>
                <h3>ì£¼ìš” ì„±ê³¼</h3>
                <ul>
                    <li>âœ… Production Ready (v1.7.0)</li>
                    <li>âœ… 30,637ê°œ ì¸ì¦ì„œ ê´€ë¦¬</li>
                    <li>âœ… 5,868ê°œ Trust Chain ê²€ì¦</li>
                    <li>âœ… ICAO 9303 ì™„ì „ ì¤€ìˆ˜</li>
                    <li>âœ… ê³ ì„±ëŠ¥ (2,222 req/s)</li>
                    <li>âœ… ARM64 ë°°í¬ ì™„ë£Œ</li>
                    <li>âœ… ì™„ì „ ìë™í™”</li>
                </ul>
            </section>

            <!-- End -->
            <section>
                <h1>ê°ì‚¬í•©ë‹ˆë‹¤</h1>
                <p>ICAO Local PKD v1.7.1</p>
                <p style="font-size: 0.8em;">4 Microservices + 2 Schedulers + Full Observability</p>
            </section>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.0/dist/reveal.js"></script>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
        
        Reveal.initialize({
            hash: true,
            center: false,
            transition: 'slide',
            width: 1280,
            height: 720,
            margin: 0.1,
            minScale: 0.2,
            maxScale: 2.0
        });
    </script>
</body>
</html>
